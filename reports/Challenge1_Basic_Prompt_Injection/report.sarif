{
  "version": "2.1.0",
  "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "MCP Security Framework",
          "version": "0.2.0",
          "informationUri": "https://github.com/yourusername/mcp-security-framework",
          "organization": "MCP Security Project",
          "semanticVersion": "0.2.0",
          "rules": [
            {
              "id": "MCP-2024-CE-001",
              "name": "Credential Exposure Detector",
              "shortDescription": {
                "text": "Credential Exposure Detector"
              },
              "fullDescription": {
                "text": "Credential Exposure Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.95,
                "precision": "high",
                "security-severity": "8.2",
                "tags": [
                  "external/cwe/CWE-522",
                  "external/owasp-llm/LLM01",
                  "external/owasp-api/API2"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-DUMMY-001",
              "name": "Dummy Detector",
              "shortDescription": {
                "text": "Dummy Detector"
              },
              "fullDescription": {
                "text": "Dummy Detector detector"
              },
              "help": {
                "text": "No issues found"
              },
              "properties": {
                "confidence": 1.0,
                "precision": "high",
                "tags": [
                  "external/cwe/CWE-0",
                  "external/owasp-llm/LLM00"
                ]
              }
            },
            {
              "id": "MCP-2024-PI-001",
              "name": "Prompt Injection via Resource Parameters",
              "shortDescription": {
                "text": "Prompt Injection via Resource Parameters"
              },
              "fullDescription": {
                "text": "Prompt Injection via Resource Parameters detector"
              },
              "help": {
                "text": "Implement input validation and sanitization on resource URIs and parameters. Restrict access to sensitive resources using authentication and authorization. Do not expose internal resource paths directly to clients."
              },
              "properties": {
                "confidence": 0.95,
                "precision": "high",
                "security-severity": "7.5",
                "tags": [
                  "external/cwe/CWE-74",
                  "external/owasp-llm/LLM01",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-TE-001",
              "name": "Tool Enumeration Analyzer",
              "shortDescription": {
                "text": "Tool Enumeration Analyzer"
              },
              "fullDescription": {
                "text": "Tool Enumeration Analyzer detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.9,
                "precision": "high",
                "security-severity": "6.5",
                "tags": [
                  "external/cwe/CWE-250",
                  "external/owasp-api/API4"
                ]
              },
              "defaultConfiguration": {
                "level": "warning"
              }
            }
          ]
        }
      },
      "invocations": [
        {
          "executionSuccessful": true,
          "startTimeUtc": "2025-10-22T22:26:55.086272+00:00",
          "endTimeUtc": "2025-10-22T22:26:56.659634+00:00",
          "workingDirectory": {
            "uri": "file:///"
          },
          "properties": {
            "scope": {
              "target": "http://localhost:9001/sse",
              "transport": "sse",
              "allowed_prefixes": [
                "internal://",
                "/"
              ],
              "blocked_paths": [],
              "rate_limit": {
                "qps": 2.0,
                "burst": 5,
                "backoff_ms": [
                  200,
                  400,
                  800,
                  1600
                ]
              },
              "policy": {
                "dry_run": false,
                "redact_evidence": true,
                "max_payload_kb": 128,
                "fail_on_high": false,
                "max_total_requests": 1000,
                "request_timeout_s": 30
              },
              "auth": {
                "type": "none",
                "api_key": null,
                "header_name": "X-API-Key",
                "token_url": null,
                "client_id": null,
                "client_secret": null
              },
              "reporting": {
                "output_dir": "./reports",
                "formats": [
                  "json",
                  "sarif",
                  "html"
                ],
                "store_evidence": true,
                "evidence_retention_days": 30
              },
              "detectors": null,
              "metadata": {}
            }
          }
        }
      ],
      "results": [
        {
          "ruleId": "MCP-2024-CE-001",
          "message": {
            "text": "Credential Exposure Detector: sensitive_exposure detected"
          },
          "level": "error",
          "properties": {
            "signal_type": "sensitive_exposure",
            "confidence": 0.95
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "internal://credentials"
                },
                "region": {
                  "startLine": 1,
                  "snippet": {
                    "text": "{'resource_uri': 'internal://credentials', 'resource_name': 'get_credentials', 'secret_types': ['passwords', 'api_keys', 'connection_strings'], 'total_secrets': 4, 'severity': 'CRITICAL', 'is_critical': True}"
                  }
                }
              }
            }
          ],
          "codeFlows": [
            {
              "message": {
                "text": "Retrieved 4 secrets (passwords, api_keys, connection_strings) from internal://credentials. Samples: passwords=[sk-a1b...i9j0, super_...d123]; api_keys=[sk-a1b...i9j0]; connection_strings=[dbuser...tion]"
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: credential_exposure"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "internal://credentials"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "method": "read_resource",
                          "uri": "internal://credentials"
                        },
                        "response": {
                          "secret_types": [
                            "passwords",
                            "api_keys",
                            "connection_strings"
                          ],
                          "total_secrets": 4,
                          "samples": {
                            "passwords": [
                              "sk-a1b...i9j0",
                              "super_...d123"
                            ],
                            "api_keys": [
                              "sk-a1b...i9j0"
                            ],
                            "connection_strings": [
                              "dbuser...tion"
                            ]
                          }
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "ruleId": "MCP-2024-PI-001",
          "message": {
            "text": "Prompt Injection via Resource Parameters: schema_overpermissive detected"
          },
          "level": "error",
          "properties": {
            "signal_type": "schema_overpermissive",
            "confidence": 0.95
          },
          "codeFlows": [
            {
              "message": {
                "text": "Accessed sensitive resource 'internal://credentials' without authentication. Contains: passwords"
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: unauthorized_access"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "internal://credentials"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "method": "read_resource",
                          "uri": "internal://credentials",
                          "authentication": "none"
                        },
                        "response": {
                          "content_length": 300,
                          "content_preview": "\n            SYSTEM CREDENTIALS\n            ------------------\n            Admin Username: admin_user\n            Admin Password: super_secret_password123\n            API Key: sk-a1b2c3d4e5f6g7h8i9j0\n            Database Connection String: postgresql://dbuser:dbpass@localhost/production\n            ",
                          "sensitive_patterns_found": [
                            "passwords"
                          ]
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "internal://credentials"
                }
              },
              "message": {
                "text": "Affected resource: internal://credentials"
              }
            }
          ]
        },
        {
          "ruleId": "MCP-2024-PI-001",
          "message": {
            "text": "Prompt Injection via Resource Parameters: sensitive_exposure detected"
          },
          "level": "error",
          "properties": {
            "signal_type": "sensitive_exposure",
            "confidence": 0.95
          },
          "codeFlows": [
            {
              "message": {
                "text": "Accessed sensitive resource 'internal://credentials' without authentication. Contains: passwords"
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: unauthorized_access"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "internal://credentials"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "method": "read_resource",
                          "uri": "internal://credentials",
                          "authentication": "none"
                        },
                        "response": {
                          "content_length": 300,
                          "content_preview": "\n            SYSTEM CREDENTIALS\n            ------------------\n            Admin Username: admin_user\n            Admin Password: super_secret_password123\n            API Key: sk-a1b2c3d4e5f6g7h8i9j0\n            Database Connection String: postgresql://dbuser:dbpass@localhost/production\n            ",
                          "sensitive_patterns_found": [
                            "passwords"
                          ]
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "internal://credentials"
                }
              },
              "message": {
                "text": "Affected resource: internal://credentials"
              }
            }
          ]
        }
      ],
      "artifacts": [
        {
          "location": {
            "uri": "internal://credentials"
          },
          "roles": [
            "analysisTarget"
          ]
        }
      ],
      "properties": {
        "assessment_id": "e5f1adaf-a175-4c76-bf13-ed355108ef31",
        "target_server": "Challenge 1 - Basic Prompt Injection",
        "target_version": "1.16.0",
        "transport": "sse",
        "exposure": "local"
      }
    }
  ]
}
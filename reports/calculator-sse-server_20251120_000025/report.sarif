{
  "version": "2.1.0",
  "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "MCP Security Framework",
          "version": "0.2.0",
          "informationUri": "https://github.com/yourusername/mcp-security-framework",
          "organization": "MCP Security Project",
          "semanticVersion": "0.2.0",
          "rules": [
            {
              "id": "MCP-2024-CE-001",
              "name": "Credential Exposure Detector",
              "shortDescription": {
                "text": "Credential Exposure Detector"
              },
              "fullDescription": {
                "text": "Credential Exposure Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.0,
                "precision": "low",
                "security-severity": "8.2",
                "tags": [
                  "external/cwe/CWE-522",
                  "external/owasp-llm/LLM01",
                  "external/owasp-api/API2"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-CEX-001",
              "name": "Code Execution Detector",
              "shortDescription": {
                "text": "Code Execution Detector"
              },
              "fullDescription": {
                "text": "Code Execution Detector detector"
              },
              "help": {
                "text": "Secure code execution: (1) Implement strict sandboxing (containers, VMs), (2) Whitelist allowed operations/modules, (3) Set resource limits (CPU, memory, time), (4) Disable dangerous functions (file I/O, network, exec), (5) Validate and sanitize all code inputs, (6) Log all executions for audit."
              },
              "properties": {
                "confidence": 0.9,
                "precision": "high",
                "security-severity": "9.8",
                "tags": [
                  "external/cwe/CWE-94",
                  "external/owasp-llm/LLM07",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-CI-001",
              "name": "Command Injection Detector",
              "shortDescription": {
                "text": "Command Injection Detector"
              },
              "fullDescription": {
                "text": "Command Injection Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.9,
                "precision": "high",
                "security-severity": "9.8",
                "tags": [
                  "external/cwe/CWE-78",
                  "external/owasp-llm/LLM07",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-DUMMY-001",
              "name": "Dummy Detector",
              "shortDescription": {
                "text": "Dummy Detector"
              },
              "fullDescription": {
                "text": "Dummy Detector detector"
              },
              "help": {
                "text": "No issues found"
              },
              "properties": {
                "confidence": 1.0,
                "precision": "high",
                "tags": [
                  "external/cwe/CWE-0",
                  "external/owasp-llm/LLM00"
                ]
              }
            },
            {
              "id": "MCP-2024-EP-001",
              "name": "Excessive Permissions Detector",
              "shortDescription": {
                "text": "Excessive Permissions Detector"
              },
              "fullDescription": {
                "text": "Excessive Permissions Detector detector"
              },
              "help": {
                "text": "Apply principle of least privilege: (1) Restrict tool parameters to specific allowed values/paths, (2) Implement path validation and sanitization, (3) Split multi-capability tools into focused tools, (4) Add explicit access control checks, (5) Document and justify any high-risk capabilities."
              },
              "properties": {
                "confidence": 0.65,
                "precision": "low",
                "security-severity": "9.1",
                "tags": [
                  "external/cwe/CWE-269",
                  "external/owasp-llm/LLM08",
                  "external/owasp-api/API6:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-II-001",
              "name": "Indirect Prompt Injection Detector",
              "shortDescription": {
                "text": "Indirect Prompt Injection Detector"
              },
              "fullDescription": {
                "text": "Indirect Prompt Injection Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.85,
                "precision": "medium",
                "security-severity": "8.1",
                "tags": [
                  "external/cwe/CWE-74",
                  "external/owasp-llm/LLM01",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-IS-001",
              "name": "Insecure Token Storage Detector",
              "shortDescription": {
                "text": "Insecure Token Storage Detector"
              },
              "fullDescription": {
                "text": "Insecure Token Storage Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.85,
                "precision": "medium",
                "security-severity": "8.6",
                "tags": [
                  "external/cwe/CWE-522",
                  "external/owasp-llm/LLM01",
                  "external/owasp-api/API2:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-PA-001",
              "name": "Privilege Abuse Detector",
              "shortDescription": {
                "text": "Privilege Abuse Detector"
              },
              "fullDescription": {
                "text": "Privilege Abuse Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.8,
                "precision": "medium",
                "security-severity": "6.5",
                "tags": [
                  "external/cwe/CWE-250",
                  "external/owasp-api/API4"
                ]
              },
              "defaultConfiguration": {
                "level": "warning"
              }
            },
            {
              "id": "MCP-2024-PI-001",
              "name": "Prompt Injection via Resource Parameters",
              "shortDescription": {
                "text": "Prompt Injection via Resource Parameters"
              },
              "fullDescription": {
                "text": "Prompt Injection via Resource Parameters detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.8,
                "precision": "medium",
                "security-severity": "7.5",
                "tags": [
                  "external/cwe/CWE-74",
                  "external/owasp-llm/LLM01",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-RUG-001",
              "name": "Tool Behavior Monitor (Rug Pull Detector)",
              "shortDescription": {
                "text": "Tool Behavior Monitor (Rug Pull Detector)"
              },
              "fullDescription": {
                "text": "Tool Behavior Monitor (Rug Pull Detector) detector"
              },
              "help": {
                "text": "Implement immutable tool definitions: (1) Lock tool descriptions after registration, (2) Use version control for tool changes, (3) Require re-approval for any modifications, (4) Implement integrity checks (hashing) to detect unauthorized changes, (5) Log all tool definition updates with audit trail."
              },
              "properties": {
                "confidence": 0.9,
                "precision": "high",
                "security-severity": "7.8",
                "tags": [
                  "external/cwe/CWE-494",
                  "external/owasp-llm/LLM03",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-TE-001",
              "name": "Tool Enumeration Analyzer",
              "shortDescription": {
                "text": "Tool Enumeration Analyzer"
              },
              "fullDescription": {
                "text": "Tool Enumeration Analyzer detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.9,
                "precision": "high",
                "security-severity": "6.5",
                "tags": [
                  "external/cwe/CWE-250",
                  "external/owasp-api/API4"
                ]
              },
              "defaultConfiguration": {
                "level": "warning"
              }
            },
            {
              "id": "MCP-2024-TP-001",
              "name": "Tool Poisoning Detector",
              "shortDescription": {
                "text": "Tool Poisoning Detector"
              },
              "fullDescription": {
                "text": "Tool Poisoning Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.9,
                "precision": "high",
                "security-severity": "8.1",
                "tags": [
                  "external/cwe/CWE-74",
                  "external/owasp-llm/LLM02",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-TS-001",
              "name": "Tool Shadowing Detector",
              "shortDescription": {
                "text": "Tool Shadowing Detector"
              },
              "fullDescription": {
                "text": "Tool Shadowing Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.9,
                "precision": "high",
                "security-severity": "7.5",
                "tags": [
                  "external/cwe/CWE-706",
                  "external/owasp-llm/LLM07",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-UA-001",
              "name": "Unauthenticated Access Detector",
              "shortDescription": {
                "text": "Unauthenticated Access Detector"
              },
              "fullDescription": {
                "text": "Unauthenticated Access Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.95,
                "precision": "high",
                "security-severity": "10.0",
                "tags": [
                  "external/cwe/CWE-284",
                  "external/owasp-api/API1"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            }
          ]
        }
      },
      "invocations": [
        {
          "executionSuccessful": true,
          "startTimeUtc": "2025-11-20T07:59:46.677319+00:00",
          "endTimeUtc": "2025-11-20T08:00:24.924609+00:00",
          "workingDirectory": {
            "uri": "file:///"
          },
          "properties": {
            "scope": {
              "target": "http://localhost:64605/sse",
              "transport": "sse",
              "mode": "balanced",
              "allowed_prefixes": [
                "internal://",
                "file://",
                "/resources",
                "/tools/"
              ],
              "blocked_paths": [
                "/admin",
                "/system"
              ],
              "rate_limit": {
                "qps": 2.0,
                "burst": 5,
                "backoff_ms": [
                  200,
                  400,
                  800,
                  1600
                ]
              },
              "policy": {
                "dry_run": false,
                "redact_evidence": true,
                "max_payload_kb": 128,
                "fail_on_high": false,
                "max_total_requests": 1000,
                "request_timeout_s": 30
              },
              "auth": {
                "type": "none",
                "api_key": null,
                "header_name": "X-API-Key",
                "token_url": null,
                "client_id": null,
                "client_secret": null
              },
              "reporting": {
                "output_dir": "./reports",
                "formats": [
                  "json",
                  "sarif",
                  "html"
                ],
                "store_evidence": true,
                "evidence_retention_days": 30
              },
              "detectors": null,
              "metadata": {}
            }
          }
        }
      ],
      "results": [
        {
          "ruleId": "MCP-2024-CEX-001",
          "message": {
            "text": "Code Execution Detector: schema_overpermissive detected"
          },
          "level": "error",
          "properties": {
            "signal_type": "schema_overpermissive",
            "confidence": 0.9
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "calculate"
                },
                "region": {
                  "startLine": 1,
                  "snippet": {
                    "text": "{'tool_name': 'calculate', 'risk_score': 0.8, 'dangerous_params': [], 'has_sandbox': False}"
                  }
                }
              }
            }
          ],
          "codeFlows": [
            {
              "message": {
                "text": "Tool 'calculate' executes arbitrary code via parameter(s): . No sandboxing detected. Risk score: 80%. Attacker can execute malicious code, access files, exfiltrate data, or compromise the system."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: code_execution"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "calculate"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "tool_name": "calculate",
                          "dangerous_params": [],
                          "test_code": "1 + 1"
                        },
                        "response": {
                          "risk_score": 0.8,
                          "has_sandboxing": false,
                          "impact": "Arbitrary code execution without restrictions"
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "ruleId": "MCP-2024-EP-001",
          "message": {
            "text": "Excessive Permissions Detector: schema_overpermissive detected"
          },
          "level": "error",
          "properties": {
            "signal_type": "schema_overpermissive",
            "confidence": 0.65
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "batch_calculate"
                },
                "region": {
                  "startLine": 1,
                  "snippet": {
                    "text": "{'tool_name': 'batch_calculate', 'risk_score': 0.6, 'capabilities': ['network_access'], 'unrestricted_params': [], 'reason': 'N/A'}"
                  }
                }
              }
            }
          ],
          "codeFlows": [
            {
              "message": {
                "text": "Tool 'batch_calculate' has excessive permissions (risk: 60%). Capabilities: network_access. Unrestricted params: 0. Potential for: external network access."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: excessive_permissions"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "batch_calculate"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "tool_name": "batch_calculate",
                          "detection_method": "capability_analysis"
                        },
                        "response": {
                          "risk_score": 0.6,
                          "capabilities": [
                            "network_access"
                          ],
                          "unrestricted_params": [],
                          "reason": "N/A"
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "ruleId": "MCP-2024-RUG-001",
          "message": {
            "text": "Tool Behavior Monitor (Rug Pull Detector): schema_overpermissive detected"
          },
          "level": "error",
          "properties": {
            "signal_type": "schema_overpermissive",
            "confidence": 0.9
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "solve_math_problem"
                },
                "region": {
                  "startLine": 1,
                  "snippet": {
                    "text": "{'tool_name': 'solve_math_problem', 'iteration': 2, 'change_type': 'response_modified'}"
                  }
                }
              }
            }
          ],
          "codeFlows": [
            {
              "message": {
                "text": "Tool 'solve_math_problem' returned different content for identical inputs after 2 invocation(s), indicating dynamic behaviour."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: rug_pull_response"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "solve_math_problem"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "tool_name": "solve_math_problem",
                          "iteration": 2
                        },
                        "response": {
                          "baseline_response": "{\n  \"problem\": \"test\",\n  \"solution\": \"Please provide a more specific mathematical expression or equation.\",\n  \"steps\": [\n    \"This problem requires advanced mathematical analysis.\",\n    \"Breaking down",
                          "modified_response": "{\n  \"problem\": \"test\",\n  \"solution\": \"Please provide a more specific mathematical expression or equation.\",\n  \"steps\": [\n    \"This problem requires advanced mathematical analysis.\",\n    \"Breaking down"
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            },
            {
              "message": {
                "text": "Tool 'explain_formula' returned different content for identical inputs after 2 invocation(s), indicating dynamic behaviour."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: rug_pull_response"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "explain_formula"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "tool_name": "explain_formula",
                          "iteration": 2
                        },
                        "response": {
                          "baseline_response": "{\n  \"formula\": \"test\",\n  \"explanation\": {\n    \"name\": \"Custom Formula\",\n    \"description\": \"This appears to be a mathematical relationship between variables\",\n    \"analysis\": \"The formula \\\"test\\\" con",
                          "modified_response": "{\n  \"formula\": \"test\",\n  \"explanation\": {\n    \"name\": \"Custom Formula\",\n    \"description\": \"This appears to be a mathematical relationship between variables\",\n    \"analysis\": \"The formula \\\"test\\\" con"
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            },
            {
              "message": {
                "text": "Tool 'calculator_assistant' returned different content for identical inputs after 2 invocation(s), indicating dynamic behaviour."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: rug_pull_response"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "calculator_assistant"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "tool_name": "calculator_assistant",
                          "iteration": 2
                        },
                        "response": {
                          "baseline_response": "{\n  \"query\": \"test\",\n  \"timestamp\": \"2025-11-20T07:59:58.044Z\",\n  \"type\": \"general\",\n  \"message\": \"I'm ready to help with mathematical calculations. Try asking me to calculate something or type \\\"help",
                          "modified_response": "{\n  \"query\": \"test\",\n  \"timestamp\": \"2025-11-20T08:00:04.812Z\",\n  \"type\": \"general\",\n  \"message\": \"I'm ready to help with mathematical calculations. Try asking me to calculate something or type \\\"help"
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "ruleId": "MCP-2024-RUG-001",
          "message": {
            "text": "Tool Behavior Monitor (Rug Pull Detector): schema_overpermissive detected"
          },
          "level": "error",
          "properties": {
            "signal_type": "schema_overpermissive",
            "confidence": 0.9
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "explain_formula"
                },
                "region": {
                  "startLine": 1,
                  "snippet": {
                    "text": "{'tool_name': 'explain_formula', 'iteration': 2, 'change_type': 'response_modified'}"
                  }
                }
              }
            }
          ],
          "codeFlows": [
            {
              "message": {
                "text": "Tool 'solve_math_problem' returned different content for identical inputs after 2 invocation(s), indicating dynamic behaviour."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: rug_pull_response"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "solve_math_problem"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "tool_name": "solve_math_problem",
                          "iteration": 2
                        },
                        "response": {
                          "baseline_response": "{\n  \"problem\": \"test\",\n  \"solution\": \"Please provide a more specific mathematical expression or equation.\",\n  \"steps\": [\n    \"This problem requires advanced mathematical analysis.\",\n    \"Breaking down",
                          "modified_response": "{\n  \"problem\": \"test\",\n  \"solution\": \"Please provide a more specific mathematical expression or equation.\",\n  \"steps\": [\n    \"This problem requires advanced mathematical analysis.\",\n    \"Breaking down"
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            },
            {
              "message": {
                "text": "Tool 'explain_formula' returned different content for identical inputs after 2 invocation(s), indicating dynamic behaviour."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: rug_pull_response"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "explain_formula"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "tool_name": "explain_formula",
                          "iteration": 2
                        },
                        "response": {
                          "baseline_response": "{\n  \"formula\": \"test\",\n  \"explanation\": {\n    \"name\": \"Custom Formula\",\n    \"description\": \"This appears to be a mathematical relationship between variables\",\n    \"analysis\": \"The formula \\\"test\\\" con",
                          "modified_response": "{\n  \"formula\": \"test\",\n  \"explanation\": {\n    \"name\": \"Custom Formula\",\n    \"description\": \"This appears to be a mathematical relationship between variables\",\n    \"analysis\": \"The formula \\\"test\\\" con"
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            },
            {
              "message": {
                "text": "Tool 'calculator_assistant' returned different content for identical inputs after 2 invocation(s), indicating dynamic behaviour."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: rug_pull_response"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "calculator_assistant"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "tool_name": "calculator_assistant",
                          "iteration": 2
                        },
                        "response": {
                          "baseline_response": "{\n  \"query\": \"test\",\n  \"timestamp\": \"2025-11-20T07:59:58.044Z\",\n  \"type\": \"general\",\n  \"message\": \"I'm ready to help with mathematical calculations. Try asking me to calculate something or type \\\"help",
                          "modified_response": "{\n  \"query\": \"test\",\n  \"timestamp\": \"2025-11-20T08:00:04.812Z\",\n  \"type\": \"general\",\n  \"message\": \"I'm ready to help with mathematical calculations. Try asking me to calculate something or type \\\"help"
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "ruleId": "MCP-2024-RUG-001",
          "message": {
            "text": "Tool Behavior Monitor (Rug Pull Detector): schema_overpermissive detected"
          },
          "level": "error",
          "properties": {
            "signal_type": "schema_overpermissive",
            "confidence": 0.9
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "calculator_assistant"
                },
                "region": {
                  "startLine": 1,
                  "snippet": {
                    "text": "{'tool_name': 'calculator_assistant', 'iteration': 2, 'change_type': 'response_modified'}"
                  }
                }
              }
            }
          ],
          "codeFlows": [
            {
              "message": {
                "text": "Tool 'solve_math_problem' returned different content for identical inputs after 2 invocation(s), indicating dynamic behaviour."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: rug_pull_response"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "solve_math_problem"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "tool_name": "solve_math_problem",
                          "iteration": 2
                        },
                        "response": {
                          "baseline_response": "{\n  \"problem\": \"test\",\n  \"solution\": \"Please provide a more specific mathematical expression or equation.\",\n  \"steps\": [\n    \"This problem requires advanced mathematical analysis.\",\n    \"Breaking down",
                          "modified_response": "{\n  \"problem\": \"test\",\n  \"solution\": \"Please provide a more specific mathematical expression or equation.\",\n  \"steps\": [\n    \"This problem requires advanced mathematical analysis.\",\n    \"Breaking down"
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            },
            {
              "message": {
                "text": "Tool 'explain_formula' returned different content for identical inputs after 2 invocation(s), indicating dynamic behaviour."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: rug_pull_response"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "explain_formula"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "tool_name": "explain_formula",
                          "iteration": 2
                        },
                        "response": {
                          "baseline_response": "{\n  \"formula\": \"test\",\n  \"explanation\": {\n    \"name\": \"Custom Formula\",\n    \"description\": \"This appears to be a mathematical relationship between variables\",\n    \"analysis\": \"The formula \\\"test\\\" con",
                          "modified_response": "{\n  \"formula\": \"test\",\n  \"explanation\": {\n    \"name\": \"Custom Formula\",\n    \"description\": \"This appears to be a mathematical relationship between variables\",\n    \"analysis\": \"The formula \\\"test\\\" con"
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            },
            {
              "message": {
                "text": "Tool 'calculator_assistant' returned different content for identical inputs after 2 invocation(s), indicating dynamic behaviour."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: rug_pull_response"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "calculator_assistant"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "tool_name": "calculator_assistant",
                          "iteration": 2
                        },
                        "response": {
                          "baseline_response": "{\n  \"query\": \"test\",\n  \"timestamp\": \"2025-11-20T07:59:58.044Z\",\n  \"type\": \"general\",\n  \"message\": \"I'm ready to help with mathematical calculations. Try asking me to calculate something or type \\\"help",
                          "modified_response": "{\n  \"query\": \"test\",\n  \"timestamp\": \"2025-11-20T08:00:04.812Z\",\n  \"type\": \"general\",\n  \"message\": \"I'm ready to help with mathematical calculations. Try asking me to calculate something or type \\\"help"
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "ruleId": "MCP-2024-TE-001",
          "message": {
            "text": "Tool contains potentially dangerous keyword 'eval' indicating system-level access"
          },
          "level": "warning",
          "properties": {
            "signal_type": "schema_overpermissive",
            "confidence": 0.9
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "advanced_calculate"
                },
                "region": {
                  "startLine": 1,
                  "snippet": {
                    "text": "{'tool_name': 'advanced_calculate', 'risk_type': 'dangerous_tool', 'severity': 'MEDIUM', 'rationale': \"Tool contains potentially dangerous keyword 'eval' indicating system-level access\", 'tool_description': 'SECURITY WARNING: This tool demonstrates unsafe expression evaluation and should NOT be used in production', 'keyword': 'eval'}"
                  }
                }
              }
            }
          ]
        },
        {
          "ruleId": "MCP-2024-UA-001",
          "message": {
            "text": "Unauthenticated Access Detector: auth_mismatch detected"
          },
          "level": "error",
          "properties": {
            "signal_type": "auth_mismatch",
            "confidence": 0.95
          },
          "codeFlows": [
            {
              "message": {
                "text": "Server exposes both tools and resources without authentication, allowing reconnaissance by unauthenticated clients."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: unauthenticated_access_test"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "MCP Server"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "operations": [
                            "list_tools",
                            "list_resources"
                          ],
                          "authenticated": false
                        },
                        "response": {
                          "tools_count": 7,
                          "resources_count": 0,
                          "tool_samples": [
                            "calculate",
                            "demo_progress",
                            "solve_math_problem",
                            "explain_formula",
                            "calculator_assistant"
                          ],
                          "resource_samples": [],
                          "vulnerable": true
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "artifacts": [],
      "properties": {
        "assessment_id": "5d32c669-52ed-4296-8cb7-cb5e12053952",
        "target_server": "calculator-sse-server",
        "target_version": "1.0.0",
        "transport": "sse",
        "exposure": "local"
      }
    }
  ]
}
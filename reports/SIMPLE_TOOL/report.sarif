{
  "version": "2.1.0",
  "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "MCP Security Framework",
          "version": "0.2.0",
          "informationUri": "https://github.com/yourusername/mcp-security-framework",
          "organization": "MCP Security Project",
          "semanticVersion": "0.2.0",
          "rules": [
            {
              "id": "MCP-2024-CEX-001",
              "name": "Code Execution Detector",
              "shortDescription": {
                "text": "Code Execution Detector"
              },
              "fullDescription": {
                "text": "Code Execution Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.85,
                "precision": "medium",
                "security-severity": "9.8",
                "tags": [
                  "external/cwe/CWE-94",
                  "external/owasp-llm/LLM07",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-CI-001",
              "name": "Command Injection Detector",
              "shortDescription": {
                "text": "Command Injection Detector"
              },
              "fullDescription": {
                "text": "Command Injection Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.9,
                "precision": "high",
                "security-severity": "9.8",
                "tags": [
                  "external/cwe/CWE-78",
                  "external/owasp-llm/LLM07",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-EP-001",
              "name": "Excessive Permissions Detector",
              "shortDescription": {
                "text": "Excessive Permissions Detector"
              },
              "fullDescription": {
                "text": "Excessive Permissions Detector detector"
              },
              "help": {
                "text": "Apply principle of least privilege: (1) Restrict tool parameters to specific allowed values/paths, (2) Implement path validation and sanitization, (3) Split multi-capability tools into focused tools, (4) Add explicit access control checks, (5) Document and justify any high-risk capabilities."
              },
              "properties": {
                "confidence": 0.65,
                "precision": "low",
                "security-severity": "9.1",
                "tags": [
                  "external/cwe/CWE-269",
                  "external/owasp-llm/LLM08",
                  "external/owasp-api/API6:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-II-001",
              "name": "Indirect Prompt Injection Detector",
              "shortDescription": {
                "text": "Indirect Prompt Injection Detector"
              },
              "fullDescription": {
                "text": "Indirect Prompt Injection Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.85,
                "precision": "medium",
                "security-severity": "8.1",
                "tags": [
                  "external/cwe/CWE-74",
                  "external/owasp-llm/LLM01",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-IS-001",
              "name": "Insecure Token Storage Detector",
              "shortDescription": {
                "text": "Insecure Token Storage Detector"
              },
              "fullDescription": {
                "text": "Insecure Token Storage Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.85,
                "precision": "medium",
                "security-severity": "8.6",
                "tags": [
                  "external/cwe/CWE-522",
                  "external/owasp-llm/LLM01",
                  "external/owasp-api/API2:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-PA-001",
              "name": "Privilege Abuse Detector",
              "shortDescription": {
                "text": "Privilege Abuse Detector"
              },
              "fullDescription": {
                "text": "Privilege Abuse Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.8,
                "precision": "medium",
                "security-severity": "6.5",
                "tags": [
                  "external/cwe/CWE-250",
                  "external/owasp-api/API4"
                ]
              },
              "defaultConfiguration": {
                "level": "warning"
              }
            },
            {
              "id": "MCP-2024-RUG-001",
              "name": "Tool Behavior Monitor (Rug Pull Detector)",
              "shortDescription": {
                "text": "Tool Behavior Monitor (Rug Pull Detector)"
              },
              "fullDescription": {
                "text": "Tool Behavior Monitor (Rug Pull Detector) detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.85,
                "precision": "medium",
                "security-severity": "7.8",
                "tags": [
                  "external/cwe/CWE-494",
                  "external/owasp-llm/LLM03",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-TE-001",
              "name": "Tool Enumeration Analyzer",
              "shortDescription": {
                "text": "Tool Enumeration Analyzer"
              },
              "fullDescription": {
                "text": "Tool Enumeration Analyzer detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.9,
                "precision": "high",
                "security-severity": "6.5",
                "tags": [
                  "external/cwe/CWE-250",
                  "external/owasp-api/API4"
                ]
              },
              "defaultConfiguration": {
                "level": "warning"
              }
            },
            {
              "id": "MCP-2024-TP-001",
              "name": "Tool Poisoning Detector",
              "shortDescription": {
                "text": "Tool Poisoning Detector"
              },
              "fullDescription": {
                "text": "Tool Poisoning Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.9,
                "precision": "high",
                "security-severity": "8.1",
                "tags": [
                  "external/cwe/CWE-74",
                  "external/owasp-llm/LLM02",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-TS-001",
              "name": "Tool Shadowing Detector",
              "shortDescription": {
                "text": "Tool Shadowing Detector"
              },
              "fullDescription": {
                "text": "Tool Shadowing Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.9,
                "precision": "high",
                "security-severity": "7.5",
                "tags": [
                  "external/cwe/CWE-706",
                  "external/owasp-llm/LLM07",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-UA-001",
              "name": "Unauthenticated Access Detector",
              "shortDescription": {
                "text": "Unauthenticated Access Detector"
              },
              "fullDescription": {
                "text": "Unauthenticated Access Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.9,
                "precision": "high",
                "security-severity": "10.0",
                "tags": [
                  "external/cwe/CWE-284",
                  "external/owasp-api/API1"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            }
          ]
        }
      },
      "invocations": [
        {
          "executionSuccessful": true,
          "startTimeUtc": "2025-11-05T23:06:08.580718+00:00",
          "endTimeUtc": "2025-11-05T23:06:17.247486+00:00",
          "workingDirectory": {
            "uri": "file:///"
          },
          "properties": {
            "scope": {
              "target": "stdio://targets\\python-sdk\\examples\\servers\\simple-tool\\.venv\\Scripts\\python.exe/-m/mcp_simple_tool",
              "transport": null,
              "mode": "aggressive",
              "allowed_prefixes": [
                "internal://",
                "file://",
                "/resources",
                "/tools/"
              ],
              "blocked_paths": [],
              "rate_limit": {
                "qps": 3.0,
                "burst": 5,
                "backoff_ms": [
                  200,
                  400,
                  800,
                  1600
                ]
              },
              "policy": {
                "dry_run": false,
                "redact_evidence": true,
                "max_payload_kb": 256,
                "fail_on_high": false,
                "max_total_requests": 1000,
                "request_timeout_s": 30
              },
              "auth": {
                "type": "none",
                "api_key": null,
                "header_name": "X-API-Key",
                "token_url": null,
                "client_id": null,
                "client_secret": null
              },
              "reporting": {
                "output_dir": "reports/SIMPLE_TOOL",
                "formats": [
                  "json",
                  "sarif",
                  "html"
                ],
                "store_evidence": true,
                "evidence_retention_days": 30
              },
              "detectors": null,
              "metadata": {}
            }
          }
        }
      ],
      "results": [
        {
          "ruleId": "MCP-2024-EP-001",
          "message": {
            "text": "Excessive Permissions Detector: schema_overpermissive detected"
          },
          "level": "error",
          "properties": {
            "signal_type": "schema_overpermissive",
            "confidence": 0.65
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "fetch"
                },
                "region": {
                  "startLine": 1,
                  "snippet": {
                    "text": "{'tool_name': 'fetch', 'risk_score': 0.65, 'capabilities': ['network_access'], 'unrestricted_params': [{'name': 'url', 'type': 'string', 'required': True}], 'reason': 'Unrestricted parameters (1) with high-risk capabilities'}"
                  }
                }
              }
            }
          ],
          "codeFlows": [
            {
              "message": {
                "text": "Tool 'fetch' has excessive permissions (risk: 65%). Capabilities: network_access. Unrestricted params: 1. Potential for: external network access."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: excessive_permissions"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "fetch"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "tool_name": "fetch",
                          "detection_method": "capability_analysis"
                        },
                        "response": {
                          "risk_score": 0.65,
                          "capabilities": [
                            "network_access"
                          ],
                          "unrestricted_params": [
                            "url"
                          ],
                          "reason": "Unrestricted parameters (1) with high-risk capabilities"
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "ruleId": "MCP-2024-UA-001",
          "message": {
            "text": "Unauthenticated Access Detector: auth_mismatch detected"
          },
          "level": "error",
          "properties": {
            "signal_type": "auth_mismatch",
            "confidence": 0.9
          },
          "codeFlows": [
            {
              "message": {
                "text": "Server exposes tool enumeration without authentication."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: unauthenticated_access_test"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "MCP Server"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "operations": [
                            "list_tools"
                          ],
                          "authenticated": false
                        },
                        "response": {
                          "tools_count": 1,
                          "resources_count": null,
                          "tool_samples": [
                            "fetch"
                          ],
                          "resource_samples": [],
                          "vulnerable": true
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "artifacts": [],
      "properties": {
        "assessment_id": "95d09e4e-21e4-4e91-bf9e-e941db5a37ed",
        "target_server": "mcp-website-fetcher",
        "target_version": "1.20.0",
        "transport": "stdio",
        "exposure": "unknown"
      }
    }
  ]
}
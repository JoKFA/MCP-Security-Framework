{
  "version": "2.1.0",
  "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "MCP Security Framework",
          "version": "0.2.0",
          "informationUri": "https://github.com/yourusername/mcp-security-framework",
          "organization": "MCP Security Project",
          "semanticVersion": "0.2.0",
          "rules": [
            {
              "id": "MCP-2024-PI-001",
              "name": "Prompt Injection via Resource Parameters",
              "shortDescription": {
                "text": "Prompt Injection via Resource Parameters"
              },
              "fullDescription": {
                "text": "Prompt Injection via Resource Parameters detector"
              },
              "help": {
                "text": "Implement input validation and sanitization on resource URIs and parameters. Restrict access to sensitive resources using authentication and authorization. Do not expose internal resource paths directly to clients."
              },
              "properties": {
                "confidence": 0.95,
                "precision": "high",
                "security-severity": "7.5",
                "tags": [
                  "external/cwe/CWE-74",
                  "external/owasp-llm/LLM01",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            }
          ]
        }
      },
      "invocations": [
        {
          "executionSuccessful": true,
          "startTimeUtc": "2025-11-24T20:31:06.887161+00:00",
          "endTimeUtc": "2025-11-24T20:31:07.306168+00:00",
          "workingDirectory": {
            "uri": "file:///"
          },
          "properties": {
            "scope": {
              "target": "http://127.0.0.1:60028/sse",
              "transport": "sse",
              "mode": "balanced",
              "allowed_prefixes": [
                "internal://",
                "file://",
                "/resources",
                "/tools/"
              ],
              "blocked_paths": [
                "/admin",
                "/system"
              ],
              "rate_limit": {
                "qps": 2.0,
                "burst": 5,
                "backoff_ms": [
                  200,
                  400,
                  800,
                  1600
                ]
              },
              "policy": {
                "dry_run": false,
                "redact_evidence": true,
                "max_payload_kb": 128,
                "fail_on_high": false,
                "max_total_requests": 1000,
                "request_timeout_s": 30
              },
              "auth": {
                "type": "none",
                "api_key": null,
                "header_name": "X-API-Key",
                "token_url": null,
                "client_id": null,
                "client_secret": null
              },
              "reporting": {
                "output_dir": "./reports",
                "formats": [
                  "json",
                  "sarif",
                  "html"
                ],
                "store_evidence": true,
                "evidence_retention_days": 30
              },
              "detectors": null,
              "metadata": {}
            }
          }
        }
      ],
      "results": [
        {
          "ruleId": "MCP-2024-PI-001",
          "message": {
            "text": "Prompt Injection via Resource Parameters: schema_overpermissive detected"
          },
          "level": "error",
          "properties": {
            "signal_type": "schema_overpermissive",
            "confidence": 0.95
          },
          "codeFlows": [
            {
              "message": {
                "text": "Accessed sensitive resource 'internal://credentials' without authentication. Contains: passwords"
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: unauthorized_access"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "internal://credentials"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "method": "read_resource",
                          "uri": "internal://credentials",
                          "authentication": "none"
                        },
                        "response": {
                          "content_length": 300,
                          "content_preview": "\n            SYSTEM CREDENTIALS\n            ------------------\n            Admin Username: admin_user\n            Admin Password: super_secret_password123\n            API Key: sk-a1b2c3d4e5f6g7h8i9j0\n            Database Connection String: postgresql://dbuser:dbpass@localhost/production\n            ",
                          "sensitive_patterns_found": [
                            "passwords"
                          ]
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "internal://credentials"
                }
              },
              "message": {
                "text": "Affected resource: internal://credentials"
              }
            }
          ]
        },
        {
          "ruleId": "MCP-2024-PI-001",
          "message": {
            "text": "Prompt Injection via Resource Parameters: sensitive_exposure detected"
          },
          "level": "error",
          "properties": {
            "signal_type": "sensitive_exposure",
            "confidence": 0.95
          },
          "codeFlows": [
            {
              "message": {
                "text": "Accessed sensitive resource 'internal://credentials' without authentication. Contains: passwords"
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: unauthorized_access"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "internal://credentials"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "method": "read_resource",
                          "uri": "internal://credentials",
                          "authentication": "none"
                        },
                        "response": {
                          "content_length": 300,
                          "content_preview": "\n            SYSTEM CREDENTIALS\n            ------------------\n            Admin Username: admin_user\n            Admin Password: super_secret_password123\n            API Key: sk-a1b2c3d4e5f6g7h8i9j0\n            Database Connection String: postgresql://dbuser:dbpass@localhost/production\n            ",
                          "sensitive_patterns_found": [
                            "passwords"
                          ]
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            }
          ],
          "relatedLocations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "internal://credentials"
                }
              },
              "message": {
                "text": "Affected resource: internal://credentials"
              }
            }
          ]
        }
      ],
      "artifacts": [
        {
          "location": {
            "uri": "internal://credentials"
          },
          "roles": [
            "analysisTarget"
          ]
        }
      ],
      "properties": {
        "assessment_id": "0a2b0911-374c-4a8c-83d2-c8d1d2b047c5",
        "target_server": "Challenge 1 - Basic Prompt Injection",
        "target_version": "1.22.0",
        "transport": "sse",
        "exposure": "unknown"
      }
    }
  ]
}
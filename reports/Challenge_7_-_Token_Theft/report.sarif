{
  "version": "2.1.0",
  "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "MCP Security Framework",
          "version": "0.2.0",
          "informationUri": "https://github.com/yourusername/mcp-security-framework",
          "organization": "MCP Security Project",
          "semanticVersion": "0.2.0",
          "rules": [
            {
              "id": "MCP-2024-CE-001",
              "name": "Credential Exposure Detector",
              "shortDescription": {
                "text": "Credential Exposure Detector"
              },
              "fullDescription": {
                "text": "Credential Exposure Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.0,
                "precision": "low",
                "security-severity": "8.2",
                "tags": [
                  "external/cwe/CWE-522",
                  "external/owasp-llm/LLM01",
                  "external/owasp-api/API2"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-CEX-001",
              "name": "Code Execution Detector",
              "shortDescription": {
                "text": "Code Execution Detector"
              },
              "fullDescription": {
                "text": "Code Execution Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.85,
                "precision": "medium",
                "security-severity": "9.8",
                "tags": [
                  "external/cwe/CWE-94",
                  "external/owasp-llm/LLM07",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-CI-001",
              "name": "Command Injection Detector",
              "shortDescription": {
                "text": "Command Injection Detector"
              },
              "fullDescription": {
                "text": "Command Injection Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.9,
                "precision": "high",
                "security-severity": "9.8",
                "tags": [
                  "external/cwe/CWE-78",
                  "external/owasp-llm/LLM07",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-DUMMY-001",
              "name": "Dummy Detector",
              "shortDescription": {
                "text": "Dummy Detector"
              },
              "fullDescription": {
                "text": "Dummy Detector detector"
              },
              "help": {
                "text": "No issues found"
              },
              "properties": {
                "confidence": 1.0,
                "precision": "high",
                "tags": [
                  "external/cwe/CWE-0",
                  "external/owasp-llm/LLM00"
                ]
              }
            },
            {
              "id": "MCP-2024-EP-001",
              "name": "Excessive Permissions Detector",
              "shortDescription": {
                "text": "Excessive Permissions Detector"
              },
              "fullDescription": {
                "text": "Excessive Permissions Detector detector"
              },
              "help": {
                "text": "Apply principle of least privilege: (1) Restrict tool parameters to specific allowed values/paths, (2) Implement path validation and sanitization, (3) Split multi-capability tools into focused tools, (4) Add explicit access control checks, (5) Document and justify any high-risk capabilities."
              },
              "properties": {
                "confidence": 0.8,
                "precision": "medium",
                "security-severity": "9.1",
                "tags": [
                  "external/cwe/CWE-269",
                  "external/owasp-llm/LLM08",
                  "external/owasp-api/API6:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-II-001",
              "name": "Indirect Prompt Injection Detector",
              "shortDescription": {
                "text": "Indirect Prompt Injection Detector"
              },
              "fullDescription": {
                "text": "Indirect Prompt Injection Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.85,
                "precision": "medium",
                "security-severity": "8.1",
                "tags": [
                  "external/cwe/CWE-74",
                  "external/owasp-llm/LLM01",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-IS-001",
              "name": "Insecure Token Storage Detector",
              "shortDescription": {
                "text": "Insecure Token Storage Detector"
              },
              "fullDescription": {
                "text": "Insecure Token Storage Detector detector"
              },
              "help": {
                "text": "Secure credential storage: (1) Never return raw tokens/keys in responses, (2) Use secure credential storage (environment variables, key vaults), (3) Implement token redaction in tool outputs, (4) Use short-lived tokens, (5) Rotate credentials regularly, (6) Log credential access for auditing."
              },
              "properties": {
                "confidence": 0.9,
                "precision": "high",
                "security-severity": "8.6",
                "tags": [
                  "external/cwe/CWE-522",
                  "external/owasp-llm/LLM01",
                  "external/owasp-api/API2:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-PA-001",
              "name": "Privilege Abuse Detector",
              "shortDescription": {
                "text": "Privilege Abuse Detector"
              },
              "fullDescription": {
                "text": "Privilege Abuse Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.8,
                "precision": "medium",
                "security-severity": "6.5",
                "tags": [
                  "external/cwe/CWE-250",
                  "external/owasp-api/API4"
                ]
              },
              "defaultConfiguration": {
                "level": "warning"
              }
            },
            {
              "id": "MCP-2024-PI-001",
              "name": "Prompt Injection via Resource Parameters",
              "shortDescription": {
                "text": "Prompt Injection via Resource Parameters"
              },
              "fullDescription": {
                "text": "Prompt Injection via Resource Parameters detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.8,
                "precision": "medium",
                "security-severity": "7.5",
                "tags": [
                  "external/cwe/CWE-74",
                  "external/owasp-llm/LLM01",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-RUG-001",
              "name": "Tool Behavior Monitor (Rug Pull Detector)",
              "shortDescription": {
                "text": "Tool Behavior Monitor (Rug Pull Detector)"
              },
              "fullDescription": {
                "text": "Tool Behavior Monitor (Rug Pull Detector) detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.85,
                "precision": "medium",
                "security-severity": "7.8",
                "tags": [
                  "external/cwe/CWE-494",
                  "external/owasp-llm/LLM03",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-TE-001",
              "name": "Tool Enumeration Analyzer",
              "shortDescription": {
                "text": "Tool Enumeration Analyzer"
              },
              "fullDescription": {
                "text": "Tool Enumeration Analyzer detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.9,
                "precision": "high",
                "security-severity": "6.5",
                "tags": [
                  "external/cwe/CWE-250",
                  "external/owasp-api/API4"
                ]
              },
              "defaultConfiguration": {
                "level": "warning"
              }
            },
            {
              "id": "MCP-2024-TP-001",
              "name": "Tool Poisoning Detector",
              "shortDescription": {
                "text": "Tool Poisoning Detector"
              },
              "fullDescription": {
                "text": "Tool Poisoning Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.9,
                "precision": "high",
                "security-severity": "8.1",
                "tags": [
                  "external/cwe/CWE-74",
                  "external/owasp-llm/LLM02",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-TS-001",
              "name": "Tool Shadowing Detector",
              "shortDescription": {
                "text": "Tool Shadowing Detector"
              },
              "fullDescription": {
                "text": "Tool Shadowing Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.9,
                "precision": "high",
                "security-severity": "7.5",
                "tags": [
                  "external/cwe/CWE-706",
                  "external/owasp-llm/LLM07",
                  "external/owasp-api/API8:2023"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "MCP-2024-UA-001",
              "name": "Unauthenticated Access Detector",
              "shortDescription": {
                "text": "Unauthenticated Access Detector"
              },
              "fullDescription": {
                "text": "Unauthenticated Access Detector detector"
              },
              "help": {
                "text": "No remediation guidance available."
              },
              "properties": {
                "confidence": 0.95,
                "precision": "high",
                "security-severity": "10.0",
                "tags": [
                  "external/cwe/CWE-284",
                  "external/owasp-api/API1"
                ]
              },
              "defaultConfiguration": {
                "level": "error"
              }
            }
          ]
        }
      },
      "invocations": [
        {
          "executionSuccessful": true,
          "startTimeUtc": "2025-11-05T21:44:57.769539+00:00",
          "endTimeUtc": "2025-11-05T21:45:10.125689+00:00",
          "workingDirectory": {
            "uri": "file:///"
          },
          "properties": {
            "scope": {
              "target": "http://localhost:9007/sse",
              "transport": null,
              "mode": "aggressive",
              "allowed_prefixes": [
                "internal://",
                "file://",
                "/resources",
                "/tools/"
              ],
              "blocked_paths": [],
              "rate_limit": {
                "qps": 3.0,
                "burst": 5,
                "backoff_ms": [
                  200,
                  400,
                  800,
                  1600
                ]
              },
              "policy": {
                "dry_run": false,
                "redact_evidence": true,
                "max_payload_kb": 256,
                "fail_on_high": false,
                "max_total_requests": 1000,
                "request_timeout_s": 30
              },
              "auth": {
                "type": "none",
                "api_key": null,
                "header_name": "X-API-Key",
                "token_url": null,
                "client_id": null,
                "client_secret": null
              },
              "reporting": {
                "output_dir": "./reports",
                "formats": [
                  "json",
                  "sarif",
                  "html"
                ],
                "store_evidence": true,
                "evidence_retention_days": 30
              },
              "detectors": null,
              "metadata": {}
            }
          }
        }
      ],
      "results": [
        {
          "ruleId": "MCP-2024-EP-001",
          "message": {
            "text": "Excessive Permissions Detector: schema_overpermissive detected"
          },
          "level": "error",
          "properties": {
            "signal_type": "schema_overpermissive",
            "confidence": 0.8
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "authenticate"
                },
                "region": {
                  "startLine": 1,
                  "snippet": {
                    "text": "{'tool_name': 'authenticate', 'risk_score': 0.8, 'capabilities': ['credential_access'], 'unrestricted_params': [], 'reason': 'High risk score (80%)'}"
                  }
                }
              }
            }
          ],
          "codeFlows": [
            {
              "message": {
                "text": "Tool 'authenticate' has excessive permissions (risk: 80%). Capabilities: credential_access. Unrestricted params: 0. Potential for: elevated privileges."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: excessive_permissions"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "authenticate"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "tool_name": "authenticate",
                          "detection_method": "capability_analysis"
                        },
                        "response": {
                          "risk_score": 0.8,
                          "capabilities": [
                            "credential_access"
                          ],
                          "unrestricted_params": [],
                          "reason": "High risk score (80%)"
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            },
            {
              "message": {
                "text": "Tool 'verify_token' has excessive permissions (risk: 80%). Capabilities: credential_access. Unrestricted params: 0. Potential for: elevated privileges."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: excessive_permissions"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "verify_token"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "tool_name": "verify_token",
                          "detection_method": "capability_analysis"
                        },
                        "response": {
                          "risk_score": 0.8,
                          "capabilities": [
                            "credential_access"
                          ],
                          "unrestricted_params": [],
                          "reason": "High risk score (80%)"
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "ruleId": "MCP-2024-EP-001",
          "message": {
            "text": "Excessive Permissions Detector: schema_overpermissive detected"
          },
          "level": "error",
          "properties": {
            "signal_type": "schema_overpermissive",
            "confidence": 0.8
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "verify_token"
                },
                "region": {
                  "startLine": 1,
                  "snippet": {
                    "text": "{'tool_name': 'verify_token', 'risk_score': 0.8, 'capabilities': ['credential_access'], 'unrestricted_params': [], 'reason': 'High risk score (80%)'}"
                  }
                }
              }
            }
          ],
          "codeFlows": [
            {
              "message": {
                "text": "Tool 'authenticate' has excessive permissions (risk: 80%). Capabilities: credential_access. Unrestricted params: 0. Potential for: elevated privileges."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: excessive_permissions"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "authenticate"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "tool_name": "authenticate",
                          "detection_method": "capability_analysis"
                        },
                        "response": {
                          "risk_score": 0.8,
                          "capabilities": [
                            "credential_access"
                          ],
                          "unrestricted_params": [],
                          "reason": "High risk score (80%)"
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            },
            {
              "message": {
                "text": "Tool 'verify_token' has excessive permissions (risk: 80%). Capabilities: credential_access. Unrestricted params: 0. Potential for: elevated privileges."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: excessive_permissions"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "verify_token"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "tool_name": "verify_token",
                          "detection_method": "capability_analysis"
                        },
                        "response": {
                          "risk_score": 0.8,
                          "capabilities": [
                            "credential_access"
                          ],
                          "unrestricted_params": [],
                          "reason": "High risk score (80%)"
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "ruleId": "MCP-2024-IS-001",
          "message": {
            "text": "Insecure Token Storage Detector: sensitive_exposure detected"
          },
          "level": "error",
          "properties": {
            "signal_type": "sensitive_exposure",
            "confidence": 0.9
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "verify_token"
                },
                "region": {
                  "startLine": 1,
                  "snippet": {
                    "text": "{'tool_name': 'verify_token', 'secret_types': ['tokens'], 'total_secrets': 1}"
                  }
                }
              }
            }
          ],
          "codeFlows": [
            {
              "message": {
                "text": "Tool 'verify_token' exposes 1 secret(s) in responses. Types: tokens. Samples: tokens=[test]. Credentials are stored/transmitted insecurely, enabling theft."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: insecure_storage"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "verify_token"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "tool": "verify_token",
                          "method": "call_tool"
                        },
                        "response": {
                          "secret_types": [
                            "tokens"
                          ],
                          "total_secrets": 1,
                          "samples": {
                            "tokens": [
                              "test"
                            ]
                          }
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "ruleId": "MCP-2024-UA-001",
          "message": {
            "text": "Unauthenticated Access Detector: auth_mismatch detected"
          },
          "level": "error",
          "properties": {
            "signal_type": "auth_mismatch",
            "confidence": 0.95
          },
          "codeFlows": [
            {
              "message": {
                "text": "Server exposes both tools and resources without authentication, allowing reconnaissance by unauthenticated clients."
              },
              "threadFlows": [
                {
                  "locations": [
                    {
                      "location": {
                        "message": {
                          "text": "Attack: unauthenticated_access_test"
                        },
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "MCP Server"
                          }
                        }
                      },
                      "state": {
                        "payload": {
                          "operations": [
                            "list_tools",
                            "list_resources"
                          ],
                          "authenticated": false
                        },
                        "response": {
                          "tools_count": 2,
                          "resources_count": 0,
                          "tool_samples": [
                            "authenticate",
                            "verify_token"
                          ],
                          "resource_samples": [],
                          "vulnerable": true
                        },
                        "success": true
                      }
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "artifacts": [],
      "properties": {
        "assessment_id": "e5bab056-662c-4e21-a990-20201d6885b3",
        "target_server": "Challenge 7 - Token Theft",
        "target_version": "1.16.0",
        "transport": "sse",
        "exposure": "local"
      }
    }
  ]
}
{
  "assessment_id": "e38e7d98-936a-4748-bd46-6e76571e9330",
  "started_at": "2025-10-28T17:28:43.066149Z",
  "completed_at": "2025-10-28T17:28:45.695523Z",
  "scope": {
    "target": "http://localhost:9001/sse",
    "transport": "sse",
    "allowed_prefixes": [
      "internal://",
      "notes://",
      "/"
    ],
    "blocked_paths": [],
    "rate_limit": {
      "qps": 2.0,
      "burst": 5,
      "backoff_ms": [
        200,
        400,
        800,
        1600
      ]
    },
    "policy": {
      "dry_run": false,
      "redact_evidence": true,
      "max_payload_kb": 128,
      "fail_on_high": false,
      "max_total_requests": 1000,
      "request_timeout_s": 30
    },
    "auth": {
      "type": "none",
      "api_key": null,
      "header_name": "X-API-Key",
      "token_url": null,
      "client_id": null,
      "client_secret": null
    },
    "reporting": {
      "output_dir": "./reports",
      "formats": [
        "json",
        "sarif",
        "html"
      ],
      "store_evidence": true,
      "evidence_retention_days": 30
    },
    "detectors": null,
    "metadata": {}
  },
  "profile": {
    "server_name": "Challenge 1 - Basic Prompt Injection",
    "server_version": "1.16.0",
    "protocol_version": "2025-06-18",
    "capabilities": {
      "resources": true,
      "tools": true,
      "prompts": true,
      "logging": false,
      "sampling": false
    },
    "transport": "sse",
    "endpoint": "http://localhost:9001/sse",
    "auth_type": "none",
    "exposure": "local",
    "metadata": {},
    "profiled_at": "2025-10-28T17:28:43.632017Z"
  },
  "results": [
    {
      "detector_id": "MCP-2024-ACTIVE-PI-001",
      "detector_name": "Active Prompt Injection Confirmation",
      "detector_version": "1.0.0",
      "status": "PRESENT",
      "confidence": 0.98,
      "affected_resources": [],
      "signals": [
        {
          "type": "reflection",
          "value": true,
          "context": {
            "resource_uri": "notes://{user_id}",
            "parameter": "user_id",
            "canary": "MCPSF_INJECT_3874c4e425542f24",
            "attack_type": "injection_test",
            "vulnerable": true,
            "proof": "Canary 'MCPSF_INJECT_3874c4e425542f24' reflected in server response"
          },
          "timestamp": "2025-10-28T17:28:43.642706Z"
        }
      ],
      "proof_of_concepts": [
        {
          "target": "notes://{user_id}",
          "attack_type": "active_injection_test",
          "payload": {
            "method": "read_resource",
            "uri": "notes://MCPSF_INJECT_3874c4e425542f24",
            "canary_injected": "MCPSF_INJECT_3874c4e425542f24",
            "parameter": "user_id"
          },
          "response": {
            "canary_found": true,
            "response_preview": "No notes found for user: MCPSF_INJECT_3874c4e425542f24",
            "vulnerable": true
          },
          "success": true,
          "impact_demonstrated": "CONFIRMED VULNERABILITY: Server reflects unsanitized input. Injected canary 'MCPSF_INJECT_3874c4e425542f24' appears in response. This proves the server does not validate/sanitize parameter values.",
          "timestamp": "2025-10-28T17:28:43.642706Z"
        }
      ],
      "evidence": {
        "resources_tested": 1,
        "parameterized_resources_found": 1,
        "vulnerable_resources": [
          {
            "resource_uri": "notes://{user_id}",
            "test_uri": "notes://MCPSF_INJECT_3874c4e425542f24",
            "canary": "MCPSF_INJECT_3874c4e425542f24",
            "parameter": "user_id",
            "response_preview": "No notes found for user: MCPSF_INJECT_3874c4e425542f24"
          }
        ],
        "exploit_attempts": [],
        "confirmations": [
          {
            "canary": "MCPSF_INJECT_3874c4e425542f24",
            "confirmed": true,
            "timestamp": "2025-10-28T17:28:43.642706+00:00"
          }
        ]
      },
      "standards": {
        "cwe": "CWE-74",
        "owasp_llm": "LLM01",
        "owasp_api": "API8:2023",
        "asvs": [
          "V5.1",
          "V9.1"
        ],
        "capec": [],
        "cvss": {
          "version": "3.1",
          "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "base_score": 7.5,
          "severity": "HIGH"
        }
      },
      "remediation": null,
      "timestamp": "2025-10-28T17:28:43.637017Z",
      "execution_time_ms": null
    },
    {
      "detector_id": "MCP-2024-ACTIVE-TA-001",
      "detector_name": "Active Tool Abuse Confirmation",
      "detector_version": "1.0.0",
      "status": "ABSENT",
      "confidence": 0.9,
      "affected_resources": [],
      "signals": [],
      "proof_of_concepts": [],
      "evidence": {
        "tools_tested": 1,
        "dangerous_tools_found": 0,
        "tools_confirmed_dangerous": [],
        "successful_calls": []
      },
      "standards": {
        "cwe": "CWE-250",
        "owasp_llm": null,
        "owasp_api": "API4",
        "asvs": [
          "V4.1"
        ],
        "capec": [],
        "cvss": {
          "version": "3.1",
          "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
          "base_score": 6.5,
          "severity": "MEDIUM"
        }
      },
      "remediation": null,
      "timestamp": "2025-10-28T17:28:43.642706Z",
      "execution_time_ms": null
    },
    {
      "detector_id": "MCP-2024-CE-001",
      "detector_name": "Credential Exposure Detector",
      "detector_version": "1.0.0",
      "status": "PRESENT",
      "confidence": 0.95,
      "affected_resources": [],
      "signals": [
        {
          "type": "sensitive_exposure",
          "value": true,
          "context": {
            "resource_uri": "internal://credentials",
            "resource_name": "get_credentials",
            "secret_types": [
              "passwords",
              "api_keys",
              "connection_strings"
            ],
            "total_secrets": 4,
            "severity": "CRITICAL",
            "is_critical": true
          },
          "timestamp": "2025-10-28T17:28:43.649705Z"
        }
      ],
      "proof_of_concepts": [
        {
          "target": "internal://credentials",
          "attack_type": "credential_exposure",
          "payload": {
            "method": "read_resource",
            "uri": "internal://credentials"
          },
          "response": {
            "secret_types": [
              "passwords",
              "api_keys",
              "connection_strings"
            ],
            "total_secrets": 4,
            "samples": {
              "passwords": [
                "sk-a1b...i9j0",
                "super_...d123"
              ],
              "api_keys": [
                "sk-a1b...i9j0"
              ],
              "connection_strings": [
                "dbuser...tion"
              ]
            }
          },
          "success": true,
          "impact_demonstrated": "Retrieved 4 secrets (passwords, api_keys, connection_strings) from internal://credentials. Samples: passwords=[sk-a1b...i9j0, super_...d123]; api_keys=[sk-a1b...i9j0]; connection_strings=[dbuser...tion]",
          "timestamp": "2025-10-28T17:28:43.649705Z"
        }
      ],
      "evidence": {
        "resources_scanned": 1,
        "sensitive_resources_found": 1,
        "secrets_by_resource": {
          "internal://credentials": {
            "resource_name": "get_credentials",
            "secret_types": [
              "passwords",
              "api_keys",
              "connection_strings"
            ],
            "total_count": 4,
            "severity": "CRITICAL",
            "secrets": {
              "passwords": [
                "sk-a1b2c3d4e5f6g7h8i9j0",
                "super_secret_password123"
              ],
              "api_keys": [
                "sk-a1b2c3d4e5f6g7h8i9j0"
              ],
              "tokens": [],
              "connection_strings": [
                "dbuser:dbpass@localhost/production"
              ],
              "private_keys": [],
              "database_urls": []
            }
          }
        }
      },
      "standards": {
        "cwe": "CWE-522",
        "owasp_llm": "LLM01",
        "owasp_api": "API2",
        "asvs": [
          "V2.1"
        ],
        "capec": [],
        "cvss": {
          "version": "3.1",
          "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "base_score": 8.2,
          "severity": "HIGH"
        }
      },
      "remediation": null,
      "timestamp": "2025-10-28T17:28:43.644705Z",
      "execution_time_ms": null
    },
    {
      "detector_id": "MCP-2024-DUMMY-001",
      "detector_name": "Dummy Detector",
      "detector_version": "1.0.0",
      "status": "ABSENT",
      "confidence": 1.0,
      "affected_resources": [],
      "signals": [],
      "proof_of_concepts": [],
      "evidence": {
        "test": "passed",
        "probes_sent": 0
      },
      "standards": {
        "cwe": "CWE-0",
        "owasp_llm": "LLM00",
        "owasp_api": null,
        "asvs": [],
        "capec": [],
        "cvss": null
      },
      "remediation": "No issues found",
      "timestamp": "2025-10-28T17:28:43.649705Z",
      "execution_time_ms": 0.0
    },
    {
      "detector_id": "MCP-2024-PI-001",
      "detector_name": "Prompt Injection via Resource Parameters",
      "detector_version": "1.0.0",
      "status": "PRESENT",
      "confidence": 0.95,
      "affected_resources": [
        "internal://credentials"
      ],
      "signals": [
        {
          "type": "schema_overpermissive",
          "value": true,
          "context": {
            "reason": "Sensitive resources exposed",
            "count": 1
          },
          "timestamp": "2025-10-28T17:28:44.271754Z"
        },
        {
          "type": "sensitive_exposure",
          "value": true,
          "context": {
            "uri": "internal://credentials",
            "content_length": 300,
            "detection_type": "sensitive_data"
          },
          "timestamp": "2025-10-28T17:28:44.880361Z"
        }
      ],
      "proof_of_concepts": [
        {
          "target": "internal://credentials",
          "attack_type": "unauthorized_access",
          "payload": {
            "method": "read_resource",
            "uri": "internal://credentials",
            "authentication": "none"
          },
          "response": {
            "content_length": 300,
            "content_preview": "\n            SYSTEM CREDENTIALS\n            ------------------\n            Admin Username: admin_user\n            Admin Password: super_secret_password123\n            API Key: sk-a1b2c3d4e5f6g7h8i9j0\n            Database Connection String: postgresql://dbuser:dbpass@localhost/production\n            ",
            "sensitive_patterns_found": [
              "passwords"
            ]
          },
          "success": true,
          "impact_demonstrated": "Accessed sensitive resource 'internal://credentials' without authentication. Contains: passwords",
          "timestamp": "2025-10-28T17:28:45.490979Z"
        }
      ],
      "evidence": {
        "total_resources": 1,
        "sensitive_resources_found": 1,
        "parameterized_resources_found": 0
      },
      "standards": {
        "cwe": "CWE-74",
        "owasp_llm": "LLM01",
        "owasp_api": "API8:2023",
        "asvs": [
          "V5.1",
          "V9.1"
        ],
        "capec": [
          "CAPEC-242"
        ],
        "cvss": {
          "version": "3.1",
          "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "base_score": 7.5,
          "severity": "HIGH"
        }
      },
      "remediation": "Implement input validation and sanitization on resource URIs and parameters. Restrict access to sensitive resources using authentication and authorization. Do not expose internal resource paths directly to clients.",
      "timestamp": "2025-10-28T17:28:45.490979Z",
      "execution_time_ms": null
    },
    {
      "detector_id": "MCP-2024-TE-001",
      "detector_name": "Tool Enumeration Analyzer",
      "detector_version": "1.0.0",
      "status": "ABSENT",
      "confidence": 0.9,
      "affected_resources": [],
      "signals": [],
      "proof_of_concepts": [],
      "evidence": {
        "tools_analyzed": 1,
        "dangerous_tools": [],
        "tools_without_validation": [],
        "risk_summary": {}
      },
      "standards": {
        "cwe": "CWE-250",
        "owasp_llm": null,
        "owasp_api": "API4",
        "asvs": [
          "V4.1"
        ],
        "capec": [],
        "cvss": {
          "version": "3.1",
          "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
          "base_score": 6.5,
          "severity": "MEDIUM"
        }
      },
      "remediation": null,
      "timestamp": "2025-10-28T17:28:45.490979Z",
      "execution_time_ms": null
    }
  ],
  "threat_model": null,
  "summary": {
    "present": 3,
    "absent": 3,
    "unknown": 0,
    "not_applicable": 0
  },
  "audit_log_path": "captures\\audit_e38e7d98-936a-4748-bd46-6e76571e9330.jsonl",
  "framework_version": "0.2.0"
}